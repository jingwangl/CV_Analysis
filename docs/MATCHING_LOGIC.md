# 简历匹配逻辑与分数计算文档

## 目录

1. [概述](#概述)
2. [匹配流程](#匹配流程)
3. [技能匹配](#技能匹配)
4. [经验匹配](#经验匹配)
5. [学历匹配](#学历匹配)
6. [综合评分计算](#综合评分计算)
7. [改进建议生成](#改进建议生成)
8. [示例说明](#示例说明)

---

## 概述

简历匹配系统通过分析简历与岗位描述的匹配度，从**技能匹配**、**经验匹配**、**学历匹配**三个维度进行评分，最终生成综合匹配分数和改进建议。

### 评分维度权重

| 维度 | 权重 | 说明 |
|------|------|------|
| 技能匹配 | 60% | 最重要的维度，衡量技能栈的匹配程度 |
| 经验匹配 | 25% | 工作年限与岗位要求的匹配度 |
| 学历匹配 | 15% | 学历背景与岗位要求的匹配度 |

**最终分数计算公式：**
```
最终分数 = 技能匹配分数 × 60% + 经验匹配分数 × 25% + 学历匹配分数 × 15%
```

---

## 匹配流程

### 1. 输入验证

系统首先验证岗位描述的有效性：

- **长度检查**：岗位描述长度需 ≥ 10 个字符
- **内容检查**：不能全是数字或特殊字符
- **关键词检查**：需包含岗位相关关键词或技能关键词

如果验证失败，返回匹配分数为 0，并提示错误原因。

### 2. 技能提取

从两个来源提取技能：

1. **从简历文本提取**：使用技能关键词库（`skills.py`）在简历文本中匹配技能
2. **从结构化信息提取**：从 `extracted_info.skills` 中获取已提取的技能

两个来源的技能会合并去重，形成完整的简历技能列表。

### 3. 多维度匹配

依次计算三个维度的匹配分数：

- 技能匹配（`_calc_skill_match`）
- 经验匹配（`_calc_experience_match`）
- 学历匹配（`_calc_education_match`）

### 4. 综合评分

根据权重计算最终分数，并生成改进建议。

---

## 技能匹配

### 匹配逻辑

#### 1. 技能标准化

为了处理大小写、空格等格式差异，所有技能会进行标准化：

- **转为小写**：`"Python"` → `"python"`
- **去除空格**：`"SQL Server"` → `"sqlserver"`
- **处理等价技能**：`"tcp/ip"` → `"tcp"`（因为会 tcp/ip 必然也会 tcp）

#### 2. 技能匹配

使用集合运算进行匹配：

- **匹配技能**：`matched = resume_skills ∩ job_skills`
- **缺失技能**：`missing = job_skills - resume_skills`
- **额外技能**：`extra = resume_skills - job_skills`

#### 3. 分数计算

```
技能匹配分数 = (匹配的技能数 / 岗位要求的技能数) × 100
```

**特殊情况：**
- 如果岗位没有技能要求，返回 50 分（中等分数）

### 示例

**岗位要求技能：** `["python", "mysql", "docker"]`

**简历技能：** `["python", "java", "redis"]`

**匹配结果：**
- 匹配技能：`["python"]`（1个）
- 缺失技能：`["mysql", "docker"]`（2个）
- 额外技能：`["java", "redis"]`（2个）

**分数计算：**
```
技能匹配分数 = 1 / 3 × 100 = 33.3 分
```

---

## 经验匹配

### 提取逻辑

#### 1. 从简历提取

从 `extracted_info.optional_info.experience_years` 中提取工作年限：

- 使用正则表达式 `r"(\d+)"` 提取数字
- 例如：`"3年经验"` → `3`

#### 2. 从岗位描述提取

使用三个正则模式依次匹配：

1. `r"(\d+)\s*年[以上]*[工作]*经[验历]"` - 匹配 "3年以上经验"、"5年工作经验"
2. `r"(\d+)\+?\s*年"` - 匹配 "3+年"、"5年"
3. `r"经[验历][：:\s]*(\d+)\s*年"` - 匹配 "经验：3年"、"经验 5年"

### 分数计算规则

| 条件 | 分数 | 说明 |
|------|------|------|
| 岗位未明确经验要求 | 70 分 | 默认中等分数 |
| 简历经验 ≥ 岗位要求 | 100 分 | 完全满足 |
| 简历经验 ≥ 岗位要求 × 0.7 | 70 分 | 基本满足（容错机制） |
| 简历经验 < 岗位要求 × 0.7 | `max(30, 简历经验/岗位要求 × 100)` | 按比例计算，最低30分 |

### 示例

#### 示例 1：完全满足

- **岗位要求**：3年
- **简历经验**：5年
- **结果**：100 分（5 ≥ 3）

#### 示例 2：基本满足

- **岗位要求**：3年
- **简历经验**：2.5年
- **计算**：2.5 ≥ 3 × 0.7 = 2.1 ✅
- **结果**：70 分

#### 示例 3：经验不足

- **岗位要求**：3年
- **简历经验**：1年
- **计算**：1 < 2.1，分数 = max(30, 1/3 × 100) = max(30, 33.3) = 33.3
- **结果**：33.3 分

#### 示例 4：经验严重不足

- **岗位要求**：3年
- **简历经验**：0.5年
- **计算**：0.5 < 2.1，分数 = max(30, 0.5/3 × 100) = max(30, 16.7) = 30
- **结果**：30 分（最低分保护）

---

## 学历匹配

### 学历等级映射

| 学历 | 等级值 |
|------|--------|
| 博士 | 5 |
| 硕士、研究生 | 4 |
| 本科、学士 | 3 |
| 大专、专科 | 2 |
| 高中 | 1 |

### 分数计算规则

| 条件 | 分数 | 说明 |
|------|------|------|
| 岗位未明确学历要求 | 70 分 | 默认中等分数 |
| 简历学历 ≥ 岗位要求 | 100 分 | 完全满足 |
| 简历学历 = 岗位要求 - 1 | 60 分 | 略低于要求（如要求本科，实际大专） |
| 简历学历 < 岗位要求 - 1 | 30 分 | 不满足要求 |

### 示例

#### 示例 1：完全满足

- **岗位要求**：本科（等级 3）
- **简历学历**：硕士（等级 4）
- **结果**：100 分（4 ≥ 3）

#### 示例 2：略低于要求

- **岗位要求**：本科（等级 3）
- **简历学历**：大专（等级 2）
- **计算**：2 = 3 - 1
- **结果**：60 分

#### 示例 3：不满足要求

- **岗位要求**：本科（等级 3）
- **简历学历**：高中（等级 1）
- **计算**：1 < 3 - 1 = 2
- **结果**：30 分

---

## 综合评分计算

### 计算公式

```
最终分数 = 技能匹配分数 × 0.60 + 经验匹配分数 × 0.25 + 学历匹配分数 × 0.15
```

### 特殊情况处理

如果岗位描述中没有提取到任何技能，且描述长度 < 50 个字符，最终分数会**降低 50%**：

```
最终分数 = 最终分数 × 0.5
```

这表示岗位描述质量不高，匹配结果不可靠。

### 示例

假设：

- **技能匹配分数**：80 分
- **经验匹配分数**：100 分
- **学历匹配分数**：100 分

**计算过程：**
```
最终分数 = 80 × 0.60 + 100 × 0.25 + 100 × 0.15
         = 48 + 25 + 15
         = 88 分
```

---

## 改进建议生成

系统会根据匹配结果自动生成改进建议：

### 1. 技能相关建议

- **缺失技能**：如果简历缺少岗位要求的技能，会提示补充
- **已匹配技能**：列出已匹配的技能，作为优势说明

### 2. 经验相关建议

- 如果经验匹配分数 < 70 分，建议在简历中更详细地描述相关工作经验

### 3. 综合评分建议

根据最终分数给出不同级别的建议：

| 分数范围 | 建议内容 |
|---------|---------|
| < 40 分 | 整体匹配度较低，建议根据岗位要求调整简历内容，突出相关技能和经验 |
| 40-60 分 | 匹配度中等，建议针对岗位要求优化简历，突出匹配的技能和项目经验 |
| 60-80 分 | 匹配度良好，建议进一步突出核心技能和项目亮点 |
| ≥ 80 分 | 简历与岗位匹配度较高，继续保持 |

### 4. 岗位描述提示

如果岗位描述中未检测到明确的技能要求，会提示提供更详细的岗位描述。

---

## 示例说明

### 完整示例

#### 输入数据

**简历信息：**
- 技能：`["Python", "MySQL", "Docker"]`
- 经验：3年
- 学历：本科

**岗位描述：**
```
招聘 Python 后端开发工程师，要求：
1. 熟悉 Python、MySQL、Redis
2. 3年以上工作经验
3. 本科及以上学历
```

#### 匹配过程

**1. 技能匹配**
- 岗位技能：`["python", "mysql", "redis"]`
- 简历技能：`["python", "mysql", "docker"]`
- 匹配技能：`["python", "mysql"]`（2个）
- 缺失技能：`["redis"]`（1个）
- 额外技能：`["docker"]`（1个）
- **技能匹配分数**：2 / 3 × 100 = 66.7 分

**2. 经验匹配**
- 岗位要求：3年
- 简历经验：3年
- **经验匹配分数**：100 分（3 ≥ 3）

**3. 学历匹配**
- 岗位要求：本科（等级 3）
- 简历学历：本科（等级 3）
- **学历匹配分数**：100 分（3 ≥ 3）

**4. 综合评分**
```
最终分数 = 66.7 × 0.60 + 100 × 0.25 + 100 × 0.15
         = 40.0 + 25.0 + 15.0
         = 80.0 分
```

**5. 改进建议**
- "建议补充以下技能：redis"
- "已匹配的技能：python, mysql"
- "匹配度良好，建议进一步突出核心技能和项目亮点"

#### 最终输出

```json
{
  "overall_score": 80.0,
  "skill_match": {
    "score": 66.7,
    "matched_skills": ["Python", "MySQL"],
    "missing_skills": ["Redis"],
    "extra_skills": ["Docker"]
  },
  "experience_match": {
    "score": 100,
    "analysis": "满足经验要求（3年 >= 3年）"
  },
  "education_match": {
    "score": 100,
    "analysis": "满足学历要求（要求本科，实际本科）"
  },
  "recommendations": [
    "建议补充以下技能：redis",
    "已匹配的技能：python, mysql",
    "匹配度良好，建议进一步突出核心技能和项目亮点"
  ]
}
```

---

## 技术细节

### 技能关键词库

系统使用统一的技能关键词库（`skills.py`），包含 200+ 个技能关键词，涵盖：

- 编程语言（Java, Python, Go, C++, JavaScript 等）
- 前端框架（React, Vue, Angular 等）
- 后端框架（Spring, Django, Flask 等）
- 数据库（MySQL, PostgreSQL, MongoDB, Redis 等）
- 工具和平台（Docker, Kubernetes, AWS, Azure 等）
- 网络协议（TCP/IP, HTTP, gRPC 等）
- AI/ML 技术（TensorFlow, PyTorch 等）
- 其他技术栈

### 技能提取算法

1. **文本预处理**：将中文标点和连接词替换为空格
2. **按长度排序**：优先匹配长技能（如 "tcp/ip" 在 "tcp" 之前）
3. **正则匹配**：使用正则表达式匹配技能关键词
4. **去重处理**：移除重复和重叠的技能

### 容错机制

- **经验匹配**：允许 70% 的容错（2.1年经验可匹配3年要求）
- **最低分保护**：经验匹配最低 30 分，避免分数过低
- **岗位描述验证**：验证岗位描述有效性，避免无效匹配

---

## 总结

简历匹配系统通过多维度分析，提供客观、量化的匹配评分。系统设计考虑了实际应用场景，包括容错机制、最低分保护等，确保匹配结果的合理性和实用性。

**核心优势：**
- ✅ 多维度综合评分
- ✅ 技能匹配权重最高（60%）
- ✅ 容错机制，避免过于严格
- ✅ 自动生成改进建议
- ✅ 支持 200+ 技能关键词

**适用场景：**
- 简历筛选
- 岗位匹配度分析
- 简历优化建议
- 人才推荐系统

